# PicLUT

**PicLUT** 是一个基于 Python 的图像色彩处理工具，可以方便地将 3D LUT（Lookup Table）应用到图片上，实现电影级的色彩风格调整。项目采用 PySide6 构建图形界面，并使用 Pillow 和 OpenCV 进行高效图像处理。

---

## 功能特点

- 支持导入多种图片格式：PNG、JPEG、BMP、TIFF、WebP 等。
- 支持加载 `.cube` 格式 3D LUT，双击列表即可快速切换。
- 支持拖放图片和 LUT 文件直接到窗口打开（可多选图片）。
- 批处理：多选图片，先预览第一张，确认后一键应用到全部并批量保存（文件名自动加 `_lut`）。
- LUT 管理面板（左侧）：列出内置与自定义 LUT，可添加/删除/重命名自定义 LUT，支持置顶（同目录内排序）与右键删除，自动轮询刷新目录变更。
- 实时预览与对比，后台线程处理避免界面卡顿。
- 暗色系 UI，带自适应图像缩放控件。
- LUT 强度滑块（0-100%）：实时预览，快速拖动也会自动校验并同步到最新强度。

---

## 安装

1. 克隆或下载本项目：

```bash
git clone https://github.com/Richthespencer/PicLUT.git
cd PicLUT
````

2. 安装依赖：

```bash
pip install -r requirements.txt
```

> 依赖库主要包括：
>
> * PySide6
> * OpenCV (`opencv-python`)
> * Pillow
> * NumPy

如果没有 `requirements.txt`，可以手动安装：

```bash
pip install PySide6 opencv-python Pillow numpy
```

---

## 使用说明

1) 运行程序

```bash
python PicLUT.py
```

2) 打开图片与LUT
- **方式一**：点击 **打开图片** / **导入 LUT** 按钮选择文件
- **方式二**：直接拖放图片或 LUT 文件到窗口（支持多选图片）

3) 单张处理
- **打开图片** → 选择一张图。
- **导入 LUT (.cube)** → 选择 LUT。
- **LUT 强度** → 拖动 0-100% 滑块实时预览；快速拖动时程序会自动校验并确保预览与滑块一致。
- **应用处理** → 后台处理完成后在右侧预览。
- **导出结果** → 选择保存路径（支持 PNG/JPEG/TIFF）。

3) 批量处理
- **打开图片** → 可多选；多选后会出现 **预览效果** 按钮。
- **预览效果** → 先对第一张应用 LUT 预览。
- **应用处理** → 对所有已选图片批量应用 LUT，使用当前滑块强度。
- 完成后自动弹出保存文件夹选择，输出文件名自动追加 `_lut`。

4) LUT 管理
- 左侧列表展示内置 LUT（LUT 目录）与自定义 LUT（LUT/Custom）。
- **添加LUT**：选择 `.cube` 文件，复制到 `LUT/Custom`（自动避免重名）。
- **删除/重命名**：仅作用于自定义目录中的 LUT；右键操作。
- **置顶**：右键置顶，置顶仅在当前目录内优先显示。
- **自动刷新**：每 3 秒轮询一次，外部新增/删除/重命名会自动更新列表。
- 双击列表项：立即加载并选中该 LUT。

5) 日志
- 底部日志区域会显示操作进度、警告与错误信息。

---

## 测试用例说明（Test Case）

本项目提供了一个用于验证 3D LUT 正确性的测试用例，说明如下：

### 测试输入

- **`test.png`**
   一张处于 **Apple Log 2（Apple Log 2 Color Space）** 色彩空间下的测试图像。
   该图像用于模拟来自 Apple 设备（如 iPhone / Apple Log 工作流）的 Log 素材输入。

- **`LUT/` 文件夹**
   该目录中包含多个 `.cube` 格式的 **3D LUT 文件**，其功能是：

  > **将 Apple Log 2 色彩空间映射到富士胶片模拟风格的 FLog2C 色彩空间**

  这些 LUT 可用于模拟富士相机胶片风格（Film Simulation）的色彩表现。

---

## 注意事项

- `.cube` 文件需为标准 3D LUT，程序会校验尺寸与数据量。
- 处理大尺寸图片时 CPU 占用较高，建议在性能充足的机器上运行。
- 若源图包含 Alpha 通道，处理前会自动移除，仅保留 RGB。